# CSI数据可视化分析工具使用指南

## 简介

这是一个专门用于探索和发现CSI数据规律的可视化工具，无需训练模型，纯粹用于数据分析和模式观察。

## 快速开始

```bash
python csi_visualization.py csi.pcap
```

或指定带宽和设备：
```bash
python csi_visualization.py csi.pcap 20 nexus5
```

## 功能列表

### 1. 全览分析 📊
一次性展示所有关键信息：
- **CSI幅度热力图**：查看所有子载波随时间的变化
- **RSSI时序图**：信号强度变化
- **平均幅度时序图**：整体信号变化趋势
- **幅度标准差**：反映信号变化的剧烈程度
- **子载波分布**：各子载波的平均强度

**使用场景**：
- 初次查看数据，获得全局印象
- 快速判断数据质量
- 识别异常时间段

### 2. 子载波时序分析 📈
详细查看特定子载波的时间序列特征：
- 时序曲线
- 均值和标准差标注
- 统计信息

**使用场景**：
- 发现哪些子载波对活动最敏感
- 观察不同子载波的变化模式
- 识别周期性变化

**示例**：
```python
# 分析第10、30、50号子载波
输入: 10,30,50
```

### 3. 频域分析 🌊
查看信号的周期性特征：
- 时域信号
- 频域频谱
- 主频率标注

**使用场景**：
- 识别周期性活动（如走动的步频）
- 区分静止和动态活动
- 发现信号的主要频率成分

**关键信息**：
- 主频率高 → 快速变化（如挥手）
- 主频率低 → 缓慢变化（如走动）
- 频谱平坦 → 随机变化或静止

### 4. 子载波相关性矩阵 🔗
显示不同子载波之间的相关性：
- 热力图展示相关系数
- 发现子载波的相关模式

**使用场景**：
- 理解子载波间的关系
- 选择最有用的子载波
- 降维分析的依据

**解读**：
- 红色（正相关）→ 两个子载波同步变化
- 蓝色（负相关）→ 两个子载波反向变化
- 白色（无相关）→ 独立变化

### 5. 相位分析 🌀
分析相位信息：
- 相位热力图
- 相位变化率

**使用场景**：
- 更精细的位置信息
- 检测微小的环境变化
- 补充幅度信息

### 6. 滑动窗口统计 📉
观察局部统计特征的变化：
- 滑动平均
- 滑动标准差
- 滑动最大/最小值

**使用场景**：
- 识别活动的开始和结束
- 发现渐变的趋势
- 平滑噪声影响

**参数建议**：
- 短窗口（20-50）：捕捉快速变化
- 长窗口（100-200）：观察整体趋势

### 7. 时间段比较 🔍
并排比较不同时间段的CSI特征：
- 多段热力图对比
- 统计信息对比

**使用场景**：
- 对比不同活动的CSI模式
- 验证活动的可重复性
- 发现活动的特征差异

**示例**：
```
比较3个时间段：
段1: 0,100 （静止）
段2: 200,300 （走动）
段3: 400,500 （挥手）
```

## 使用流程建议

### 步骤1: 快速全览
```
选择1 → 查看全览分析
```
观察：
- 数据是否有明显的变化模式？
- 有没有异常的时间段？
- RSSI和CSI幅度是否一致？

### 步骤2: 识别关键时间段
从全览图中识别不同的活动段，例如：
- 0-200: 静止
- 200-400: 走动
- 400-600: 挥手

### 步骤3: 对比时间段
```
选择7 → 输入各个时间段
```
观察不同活动的CSI模式差异：
- 静止：热力图颜色均匀，标准差小
- 走动：有规律的周期性变化
- 挥手：剧烈变化，标准差大

### 步骤4: 频域分析
```
选择3 → 分析各个时间段的主频率
```
记录不同活动的频率特征：
- 静止：接近0Hz
- 走动：1-2Hz（步频）
- 挥手：3-5Hz（更快）

### 步骤5: 子载波选择
```
选择2 → 分析不同子载波
选择4 → 查看相关性
```
找出对活动最敏感的子载波。

### 步骤6: 总结规律
记录发现的规律，例如：
```
活动特征总结：
1. 静止：
   - 平均幅度稳定
   - 标准差 < 0.5
   - 主频率 < 0.1 Hz

2. 走动：
   - 周期性变化
   - 标准差 0.5-1.5
   - 主频率 1-2 Hz

3. 挥手：
   - 剧烈变化
   - 标准差 > 2.0
   - 主频率 3-5 Hz
```

## 实用技巧

### 技巧1: 快速识别活动类型
1. 看**标准差**：越大表示变化越剧烈
2. 看**主频率**：反映活动的快慢
3. 看**热力图颜色变化**：规律性vs随机性

### 技巧2: 选择敏感子载波
- 观察热力图中变化最明显的子载波
- 使用相关性矩阵找到独立的子载波
- 选择3-5个代表性子载波即可

### 技巧3: 窗口大小选择
- **活动检测**：窗口 = 1-2秒的样本数
- **特征提取**：窗口 = 3-5秒的样本数
- **趋势分析**：窗口 = 10+秒的样本数

### 技巧4: 识别噪声
- RSSI突变 → 可能是信号干扰
- 热力图出现垂直线 → 瞬时噪声
- 某些子载波异常 → 硬件问题

## 数据收集建议

为了更好地观察规律，建议：

1. **纯净样本**：每个活动单独录制，避免混杂
2. **足够时长**：每个活动至少10-30秒
3. **多次重复**：同一活动录制3-5次
4. **标注时间**：记录每个活动的开始和结束时间
5. **环境一致**：在相同位置、相同环境下录制

## 示例分析流程

```bash
# 1. 加载数据
python csi_visualization.py walking.pcap

# 2. 全览（选择1）
观察到：200-700样本段有明显周期性变化

# 3. 频域分析（选择3）
发现主频率约1.5Hz，符合走动的步频

# 4. 子载波分析（选择2）
输入：16,32,48
发现：第32号子载波变化最明显

# 5. 时间段对比（选择7）
对比段1(0-200)静止 vs 段2(200-400)走动
发现：走动段的标准差是静止段的3倍

# 6. 总结规律
走动特征：
- 标准差: 1.2±0.3
- 主频率: 1.5 Hz
- 敏感子载波: 32
```

## 常见问题

### Q1: 看不出明显规律？
- 确认活动是否真的有差异
- 尝试更大的动作幅度
- 检查信号质量（RSSI）

### Q2: 热力图全是一个颜色？
- 可能是数据范围问题
- 尝试查看标准差图
- 使用时间段对比功能

### Q3: 频域分析没有明显峰值？
- 可能是非周期性活动
- 尝试增加数据长度
- 查看滑动窗口统计

## 下一步

发现规律后，可以：
1. 记录各活动的特征阈值
2. 使用这些阈值进行简单的规则分类
3. 或者转向机器学习方法（使用activity_recognition.py）

## 保存结果

使用matplotlib的保存功能：
- 在图表窗口点击保存按钮
- 或在代码中添加 `plt.savefig('result.png')`
